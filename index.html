<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Powerball Helper (Plain HTML)</title>
<style>
  :root {
    --bg: #0d1117;
    --panel: #161b22;
    --text: #e6edf3;
    --muted: #9fb0c0;
    --accent: #3fb950;
    --accent-2: #2f81f7;
    --warn: #f0883e;
    --danger: #f85149;
    --border: #30363d;
  }
  * { box-sizing: border-box; }
  body {
    margin: 0; font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    background: var(--bg); color: var(--text);
  }
  header {
    padding: 16px 20px; border-bottom: 1px solid var(--border);
    background: #0b0f14; position: sticky; top: 0; z-index: 10;
  }
  header h1 { margin: 0 0 4px; font-size: 20px; }
  header p { margin: 0; color: var(--muted); font-size: 13px; }
  main { max-width: 1100px; margin: 20px auto; padding: 0 16px 40px; display: grid; gap: 16px; }
  section {
    background: var(--panel); border: 1px solid var(--border);
    border-radius: 10px; padding: 14px;
  }
  section h2 { margin: 0 0 10px; font-size: 18px; }
  .row { display: flex; flex-wrap: wrap; gap: 10px; align-items: center; }
  label { color: var(--muted); font-size: 14px; }
  input[type="number"], select, input[type="text"] {
    background: #0f141a; color: var(--text); border: 1px solid var(--border);
    border-radius: 8px; padding: 8px 10px; min-width: 70px;
  }
  input[type="number"]:invalid { border-color: var(--danger); }
  button {
    border: 1px solid var(--border); background: #0f141a; color: var(--text);
    border-radius: 8px; padding: 8px 12px; cursor: pointer;
  }
  button.primary { border-color: #2b9348; background: #123018; }
  button.accent { border-color: var(--accent-2); background: #0f1f3a; }
  button.warn { border-color: var(--warn); background: #2a190a; }
  button.danger { border-color: var(--danger); background: #2a0f12; }
  button:disabled { opacity: 0.6; cursor: not-allowed; }

  table { width: 100%; border-collapse: collapse; }
  th, td { border-bottom: 1px solid var(--border); padding: 8px 6px; text-align: left; }
  th { color: var(--muted); font-weight: 600; }
  code.badge {
    border: 1px solid var(--border); padding: 2px 6px; border-radius: 999px;
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
    font-size: 12px; color: #c9d1d9; background: #0f141a;
  }
  .balls { display: inline-flex; gap: 6px; flex-wrap: wrap; }
  .ball, .pb {
    display: inline-flex; align-items: center; justify-content: center;
    width: 30px; height: 30px; border-radius: 50%; font-weight: 700;
    border: 1px solid var(--border); background: #0f141a;
  }
  .pb { background: #1a0f12; border-color: #7f1d1d; }
  .hint { color: var(--muted); font-size: 12px; }
  .flex-between { display: flex; justify-content: space-between; gap: 10px; align-items: center; }
  .grid {
    display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 10px;
  }
  .ticket-card {
    border: 1px dashed var(--border); border-radius: 10px; padding: 10px;
    background: #0f141a;
  }
  .ticket-card .meta { color: var(--muted); font-size: 12px; }
  .right { text-align: right; }
  .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }

  @media print {
    header, .no-print { display: none !important; }
    body { background: white; color: black; }
    section { border: none; background: white; }
    .ticket-card { border: 1px solid #aaa; background: white; }
  }
</style>
</head>
<body>
<header>
  <h1>Powerball Helper</h1>
  <p>Organize tickets, check results, export/print. (Does <em>not</em> improve odds.)</p>
</header>

<main>
  <!-- Generator -->
  <section>
    <div class="flex-between">
      <h2>1) Generate Tickets</h2>
      <div class="hint">White balls 1–69 (5 distinct) + Powerball 1–26</div>
    </div>
    <div class="row no-print" style="margin-bottom:10px">
      <label>How many
        <input type="number" id="qty" min="1" max="1000" value="5" />
      </label>
      <label>Mode
        <select id="mode">
          <option value="random">Pure random</option>
          <option value="less_common">“Less-common style”</option>
        </select>
      </label>
      <button id="genBtn" class="primary">Generate</button>
      <button id="clearGenBtn">Clear generated</button>
      <span class="hint">“Less-common style” avoids obvious patterns to slightly reduce split risk only.</span>
    </div>
    <div id="generatedWrap"></div>
    <div class="row no-print" style="margin-top:8px">
      <button id="saveSelectedBtn" class="accent">Save selected</button>
      <button id="saveAllBtn" class="accent">Save all</button>
    </div>
  </section>

  <!-- Saved tickets -->
  <section>
    <div class="flex-between">
      <h2>2) Saved Tickets (persist in your browser)</h2>
      <div id="bankroll" class="hint"></div>
    </div>
    <div id="savedWrap"></div>
    <div class="row no-print" style="margin-top:8px">
      <button id="removeSelectedBtn" class="warn">Remove selected</button>
      <button id="clearAllBtn" class="danger">Clear all</button>
      <button id="exportCsvBtn" class="accent">Export CSV</button>
      <button id="printBtn">Print slips</button>
    </div>
  </section>

  <!-- Results check -->
  <section>
    <h2>3) Check Results</h2>
    <div class="row no-print">
      <label>Winning Whites
        <input type="text" id="winningWhites" placeholder="e.g. 8 23 25 40 53" />
      </label>
      <label>Powerball
        <input type="number" id="winningPB" min="1" max="26" placeholder="1–26" />
      </label>
      <button id="checkBtn" class="primary">Check Saved Tickets</button>
      <span class="hint">CA prizes (non-jackpot) are pari-mutuel & variable. This reports match <em>tiers</em>.</span>
    </div>
    <div id="resultsWrap" style="margin-top:8px"></div>
  </section>

  <!-- Simulation -->
  <section>
    <h2>4) Reality Check (Quick Simulation)</h2>
    <div class="row no-print">
      <label>Trials
        <input type="number" id="trialCount" min="1" max="5000000" value="200000" />
      </label>
      <button id="simBtn">Simulate jackpot hits</button>
      <span class="hint">Jackpot odds ≈ 1 in 292,201,338.</span>
    </div>
    <div id="simOut" style="margin-top:8px" class="mono"></div>
  </section>
</main>

<script>
/* ===========================
   POWERBALL HELPER (Plain JS)
   — Helps manage tickets and check results.
   — Does not improve odds or guarantee accuracy of payouts.
   =========================== */

const WHITE_MIN = 1, WHITE_MAX = 69;
const PB_MIN = 1, PB_MAX = 26;
const TICKET_PRICE = 2;
const JACKPOT_ODDS = 292_201_338;

// CA tiers: amounts vary (pari-mutuel). We only name the tier.
const TIERS = new Map([
  [[5, true].toString(),  "Jackpot"],
  [[5, false].toString(), "Match 5 (CA: pari-mutuel)"],
  [[4, true].toString(),  "Match 4 + PB (CA: pari-mutuel)"],
  [[4, false].toString(), "Match 4 (CA: pari-mutuel)"],
  [[3, true].toString(),  "Match 3 + PB (CA: pari-mutuel)"],
  [[3, false].toString(), "Match 3 (CA: pari-mutuel)"],
  [[2, true].toString(),  "Match 2 + PB (CA: pari-mutuel)"],
  [[1, true].toString(),  "Match 1 + PB (CA: pari-mutuel)"],
  [[0, true].toString(),  "Powerball only (CA: pari-mutuel)"],
]);

/* ---------- Utilities ---------- */
const $ = sel => document.querySelector(sel);
function randint(min, maxIncl) {
  return Math.floor(Math.random() * (maxIncl - min + 1)) + min;
}
function sampleDistinctIntegers(count, min, maxIncl) {
  if (count > (maxIncl - min + 1)) throw new Error("Range too small");
  const set = new Set();
  while (set.size < count) set.add(randint(min, maxIncl));
  return [...set].sort((a, b) => a - b);
}
function fmtBalls(whites, pb) {
  const whitesHtml = whites.map(n => `<span class="ball">${n}</span>`).join("");
  return `<span class="balls">${whitesHtml}<span class="pb">${pb}</span></span>`;
}
function parseWhitesInput(str) {
  // Accepts "8 23 25 40 53" or "8,23,25,40,53"
  const parts = (str || "").replace(/,/g, " ").trim().split(/\s+/).filter(Boolean);
  if (parts.length !== 5) throw new Error("Enter exactly five white-ball numbers.");
  const nums = parts.map(x => Number(x));
  if (nums.some(n => !Number.isInteger(n) || n < WHITE_MIN || n > WHITE_MAX))
    throw new Error("Whites must be integers 1–69.");
  const set = new Set(nums);
  if (set.size !== 5) throw new Error("White numbers must be distinct.");
  return [...set].sort((a, b) => a - b);
}
function csvFromTickets(tix) {
  const lines = ["w1,w2,w3,w4,w5,pb"];
  for (const t of tix) lines.push([...t.whites, t.pb].join(","));
  return lines.join("\n");
}

/* ---------- Ticket Generators ---------- */
function quickPick() {
  const whites = sampleDistinctIntegers(5, WHITE_MIN, WHITE_MAX);
  const pb = randint(PB_MIN, PB_MAX);
  return { whites, pb };
}
function lessCommonStylePick() {
  // Avoids 1,2,3,4,5 and ensures at least two > 31 to dodge birthday clustering.
  while (true) {
    const { whites, pb } = quickPick();
    const notSequence = whites.toString() !== [1,2,3,4,5].toString();
    const highCount = whites.filter(n => n > 31).length;
    if (notSequence && highCount >= 2) return { whites, pb };
  }
}
function generateTickets(n = 5, mode = "random") {
  const picks = [];
  for (let i = 0; i < n; i++) {
    picks.push(mode === "less_common" ? lessCommonStylePick() : quickPick());
  }
  return picks;
}

/* ---------- Checking ---------- */
function checkTicket(ticket, winning) {
  const setW = new Set(winning.whites);
  const whiteMatches = ticket.whites.filter(n => setW.has(n)).length;
  const pbMatch = ticket.pb === winning.pb;
  const tier = TIERS.get([whiteMatches, pbMatch].toString()) || "No prize";
  return { ticket, whiteMatches, pbMatch, tier };
}

/* ---------- State (Saved Tickets) ---------- */
const LS_KEY = "pb_saved_tickets_v1";
let savedTickets = [];
function loadSaved() {
  try {
    const raw = localStorage.getItem(LS_KEY);
    savedTickets = raw ? JSON.parse(raw) : [];
  } catch { savedTickets = []; }
}
function persistSaved() {
  localStorage.setItem(LS_KEY, JSON.stringify(savedTickets));
  updateBankroll();
}
function updateBankroll() {
  const draws = savedTickets.length;
  $("#bankroll").textContent = draws
    ? `Saved: ${draws} tickets → Cost per draw: $${(draws * TICKET_PRICE).toLocaleString()}`
    : "No saved tickets yet.";
}

/* ---------- Rendering ---------- */
function renderGenerated(list) {
  const wrap = $("#generatedWrap");
  if (!list || !list.length) { wrap.innerHTML = `<p class="hint">Nothing generated yet.</p>`; return; }
  let rows = list.map((t, idx) => `
    <tr>
      <td><input type="checkbox" data-idx="${idx}" class="gen-check"></td>
      <td class="mono">#${idx+1}</td>
      <td>${fmtBalls(t.whites, t.pb)}</td>
      <td><code class="badge">${t.whites.join(",")} | PB ${t.pb}</code></td>
    </tr>`).join("");
  wrap.innerHTML = `
    <table>
      <thead><tr>
        <th><input type="checkbox" id="genAll"></th>
        <th>#</th><th>Numbers</th><th>Raw</th>
      </tr></thead>
      <tbody>${rows}</tbody>
    </table>`;
  const genAll = $("#genAll");
  genAll?.addEventListener("change", () => {
    document.querySelectorAll(".gen-check").forEach(cb => cb.checked = genAll.checked);
  });
}
function renderSaved() {
  const wrap = $("#savedWrap");
  if (!savedTickets.length) { wrap.innerHTML = `<p class="hint">No tickets saved yet.</p>`; return; }
  let rows = savedTickets.map((t, idx) => `
    <tr>
      <td><input type="checkbox" data-idx="${idx}" class="save-check"></td>
      <td class="mono">#${idx+1}</td>
      <td>${fmtBalls(t.whites, t.pb)}</td>
      <td><code class="badge">${t.whites.join(",")} | PB ${t.pb}</code></td>
    </tr>`).join("");
  wrap.innerHTML = `
    <table>
      <thead><tr>
        <th><input type="checkbox" id="saveAll"></th>
        <th>#</th><th>Numbers</th><th>Raw</th>
      </tr></thead>
      <tbody>${rows}</tbody>
    </table>
    <div class="grid" style="margin-top:10px">
      ${savedTickets.map((t,i)=>`
        <div class="ticket-card">
          <div class="meta">Ticket ${i+1}</div>
          <div style="margin:6px 0">${fmtBalls(t.whites, t.pb)}</div>
          <div class="meta">${t.whites.join(" – ")} | PB ${t.pb}</div>
        </div>`).join("")}
    </div>
  `;
  const saveAll = $("#saveAll");
  saveAll?.addEventListener("change", () => {
    document.querySelectorAll(".save-check").forEach(cb => cb.checked = saveAll.checked);
  });
}
function renderResults(res) {
  const wrap = $("#resultsWrap");
  if (!res.length) { wrap.innerHTML = `<p class="hint">No results to show.</p>`; return; }
  let rows = res.map((r, idx) => `
    <tr>
      <td class="mono">#${idx+1}</td>
      <td>${fmtBalls(r.ticket.whites, r.ticket.pb)}</td>
      <td>${r.whiteMatches}</td>
      <td>${r.pbMatch ? "Yes" : "No"}</td>
      <td>${r.tier}</td>
    </tr>`).join("");
  wrap.innerHTML = `
    <table>
      <thead>
        <tr><th>#</th><th>Ticket</th><th>White matches</th><th>PB match</th><th>Tier</th></tr>
      </thead>
      <tbody>${rows}</tbody>
    </table>`;
}

/* ---------- Handlers ---------- */
let lastGenerated = [];
$("#genBtn").addEventListener("click", () => {
  const qty = Math.max(1, Math.min(1000, Number($("#qty").value || 0)));
  const mode = $("#mode").value;
  lastGenerated = generateTickets(qty, mode);
  renderGenerated(lastGenerated);
});
$("#clearGenBtn").addEventListener("click", () => {
  lastGenerated = [];
  renderGenerated(lastGenerated);
});

$("#saveSelectedBtn").addEventListener("click", () => {
  const checks = [...document.querySelectorAll(".gen-check")];
  const selectedIdx = checks.filter(cb => cb.checked).map(cb => Number(cb.dataset.idx));
  if (!selectedIdx.length) return alert("Select at least one generated ticket to save.");
  for (const i of selectedIdx) savedTickets.push(lastGenerated[i]);
  persistSaved(); renderSaved();
});
$("#saveAllBtn").addEventListener("click", () => {
  if (!lastGenerated.length) return alert("Nothing to save.");
  savedTickets.push(...lastGenerated);
  persistSaved(); renderSaved();
});

$("#removeSelectedBtn").addEventListener("click", () => {
  const checks = [...document.querySelectorAll(".save-check")];
  const idxToRemove = new Set(checks.filter(cb => cb.checked).map(cb => Number(cb.dataset.idx)));
  if (!idxToRemove.size) return alert("Select at least one saved ticket to remove.");
  savedTickets = savedTickets.filter((_, i) => !idxToRemove.has(i));
  persistSaved(); renderSaved();
});
$("#clearAllBtn").addEventListener("click", () => {
  if (!savedTickets.length) return;
  if (confirm("Clear ALL saved tickets?")) {
    savedTickets = [];
    persistSaved(); renderSaved();
  }
});

$("#exportCsvBtn").addEventListener("click", () => {
  if (!savedTickets.length) return alert("No saved tickets to export.");
  const csv = csvFromTickets(savedTickets);
  const blob = new Blob([csv], { type: "text/csv;charset=utf-8" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement("a");
  a.href = url; a.download = "powerball_tickets.csv";
  document.body.appendChild(a); a.click();
  a.remove(); URL.revokeObjectURL(url);
});
$("#printBtn").addEventListener("click", () => window.print());

$("#checkBtn").addEventListener("click", () => {
  if (!savedTickets.length) return alert("Save some tickets first.");
  let whites, pb;
  try {
    whites = parseWhitesInput($("#winningWhites").value);
    pb = Number($("#winningPB").value);
    if (!Number.isInteger(pb) || pb < PB_MIN || pb > PB_MAX) throw new Error("PB must be 1–26.");
  } catch (e) {
    return alert(e.message);
  }
  const winning = { whites, pb };
  const results = savedTickets.map(t => checkTicket(t, winning));
  renderResults(results);
});

$("#simBtn").addEventListener("click", () => {
  const trials = Math.max(1, Math.min(5_000_000, Number($("#trialCount").value || 0)));
  let hits = 0;
  for (let i = 0; i < trials; i++) if (randint(1, JACKPOT_ODDS) === 1) hits++;
  const expected = trials / JACKPOT_ODDS;
  $("#simOut").textContent = `Trials: ${trials.toLocaleString()} | Jackpot hits observed: ${hits} | Expected ≈ ${expected.toFixed(3)}`;
});

/* ---------- Init ---------- */
loadSaved();
renderSaved();
renderGenerated([]);
updateBankroll();

</script>
</body>
</html>